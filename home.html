<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Home</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon1.ico" />
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous"/>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/style.css" rel="stylesheet" />
        <script type="text/javascript" src="js/verify.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> 
        <script>
      $(function(){
        $("#sidebar").load("sidebar.html");
      });
      </script> 
      </head>
      <body class="home-body bg-dark">
          <div class="container home-cont">
          <div id="sidebar"></div>
          <main class="home-main d-flex flex-nowrap">
            <div class='middle border border-light border-1 border-top-0 border-bottom-0 position-relative' id="middle">
              <div class="avis-create">
                <h1>hello</h1>
              </div>
              <div class="avis-show" id="hideme">
                <div class="avis-cards">
                  <div class="card bg-dark" id="card">
                    <div class="card-body">
                      <div class="avis-card-head">
                      <h6 class="card-title" id="card-fullname">fullname</h6>
                      <h8 class="card-subtitle mb-2 text-muted" id="card-username">username</h8>
                    </div>
                      <p class="card-text" id="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                    </div>
                  </div>
                </div>
              </div>  
            </div>
          </main>
        </div>
      </body>
      <script type="text/javascript">
        window.onload = async(e) => {
          e.preventDefault();

          let response = await fetch('http://127.0.0.1:8000/all_avis', {
            method: 'GET',
            headers: {
              'Content-Type': 'application/json',
            },
        })
        let avis = await response.json();
        //avis.forEach((f) => {
          //console.log(f)
        //})
        if(avis.length>0){
            
          avis.forEach( a =>{

            document.getElementById("hideme").style.display = "block";
            
            let avis_cards = document.createElement('div');
            avis_cards.className = 'avis-cards';

            let card = document.createElement('div');
            card.className = 'card bg-dark';
            avis_cards.appendChild(card);

            let card_body = document.createElement('div');
            card_body.className = 'card-body';
            card.appendChild(card_body);

            let avis_card_head = document.createElement('div');
            avis_card_head.className = 'avis-card-head';
            card_body.appendChild(avis_card_head);

            let title = document.createElement('h6');
            title.innerText = 'fullname';
            title.className = 'card-title';
            title.id="card-fullname";
            avis_card_head.appendChild(title);

            let subtitle = document.createElement('h8');
            subtitle.innerText = 'username';
            subtitle.className = 'card-subtitle mb-2 text-muted';
            subtitle.id = 'card-username';
            avis_card_head.appendChild(subtitle);

            let text = document.createElement('p');
            text.innerText = a.body;
            text.className = 'card-text';
            text.id = 'card-text'
            card_body.appendChild(text);

            document.getElementById('hideme').appendChild(avis_cards);

        })
        }
        else{
          let container = document.getElementsByClassName('avis-cards');
            document.getElementById("hideme").style.display = "flex";

          let no_content = document.createElement('div');
          no_content.innerHTML =  `<h4> Nothing to show here.</h4>`;
          no_content.className = 'bg-dark';

          document.getElementsByClassName('avis-cards').replaceWith(container);
        }
      }
      </script>
</html>    

               